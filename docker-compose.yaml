version: "3.8"

services:
  core:
    image: tools/main
    build: core
    restart: always
    env_file: ./.env
    ports:
      - 8101:8101
    volumes:
      - .m2:/root/.m2
    stdin_open: true
    tty: true
    environment:
    - SPRING_PROFILES_ACTIVE=$ENVIRONMENT
  khqr:
    image: tools/khqr
    build: tools.khqr
    restart: always
    env_file: ./.env
    ports:
      - 8102:8102
    volumes:
      - .m2:/root/.m2
    stdin_open: true
    tty: true
    environment:
      - SPRING_PROFILES_ACTIVE=$ENVIRONMENT
  frontend:
    image: tools/frontend
    build: frontend
    ports:
      - $SPRING_HOST_PORT:$SPRING_DOCKER_PORT
      - '35729:35729'
    volumes:
      - ./frontend/:/opt/frontend